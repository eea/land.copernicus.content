<tal:scripts define="dsn view/get_dsn;
                     sentry_release view/get_sentry_release;
                     sentry_url view/get_sentry_url;
                     sentry_environment view/get_sentry_environment"
      tal:condition="dsn">

  <span data-diazo="raven-scripts">
    <script type="text/javascript"
      tal:attributes="src string:${context/portal_url}/++resource++land.copernicus.content.static/lib/raven.min.js"></script>

    <script type="text/javascript">
      $(function(){
        if(Raven) Raven.config('${dsn}', {
          logger: 'javascript',
          release: '${sentry_release}',
          url: '${sentry_url}',
          environment: '${sentry_environment}',
          ignoreErrors: [
            'jQuery is not defined',
            '$ is not defined',
            'Can\'t find variable: jQuery',
            'Socialite is not defined',
            'Persistent storage maximum size reached'
          ]
        }).install();
      });
    </script>
  </span>
</tal:scripts>
