<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<body>

<metal:description fill-slot="content-description" />

<metal:content-core fill-slot="content-core">
<metal:main_macro define-macro="content-core">
  <script>
    function show_iframe(){
      jQuery(".loading_message").hide();
    }
  </script>
  <style>
  @import url("http://cdn.datatables.net/1.10.6/css/jquery.dataTables.min.css");
  @import url("./eea-tooltips.css");

  .loading_message {
    height:450px; 
    width:900px;
    line-height:450px;
    position:absolute;
  }
  #squaresWaveG{
    position:absolute;
    top:250px;
    left:330px;
    width:240px;
    height:29px;
  z-index:1000;}

  .squaresWaveG{
    position:absolute;
    top:0;
    background-color:#C0D630;
    width:29px;
    height:29px;
    -moz-animation-name:bounce_squaresWaveG;
    -moz-animation-duration:1.3s;
    -moz-animation-iteration-count:infinite;
    -moz-animation-direction:linear;
    -webkit-animation-name:bounce_squaresWaveG;
    -webkit-animation-duration:1.3s;
    -webkit-animation-iteration-count:infinite;
    -webkit-animation-direction:linear;
    -ms-animation-name:bounce_squaresWaveG;
    -ms-animation-duration:1.3s;
    -ms-animation-iteration-count:infinite;
    -ms-animation-direction:linear;
    -o-animation-name:bounce_squaresWaveG;
    -o-animation-duration:1.3s;
    -o-animation-iteration-count:infinite;
    -o-animation-direction:linear;
    animation-name:bounce_squaresWaveG;
    animation-duration:1.3s;
    animation-iteration-count:infinite;
    animation-direction:linear;
  }

  #squaresWaveG_1{
    left:0;
    -moz-animation-delay:0.52s;
    -webkit-animation-delay:0.52s;
    -ms-animation-delay:0.52s;
    -o-animation-delay:0.52s;
    animation-delay:0.52s;
  }

  #squaresWaveG_2{
    left:30px;
    -moz-animation-delay:0.65s;
    -webkit-animation-delay:0.65s;
    -ms-animation-delay:0.65s;
    -o-animation-delay:0.65s;
    animation-delay:0.65s;
  }

  #squaresWaveG_3{
    left:60px;
    -moz-animation-delay:0.78s;
    -webkit-animation-delay:0.78s;
    -ms-animation-delay:0.78s;
    -o-animation-delay:0.78s;
    animation-delay:0.78s;
  }

  #squaresWaveG_4{
    left:90px;
    -moz-animation-delay:0.91s;
    -webkit-animation-delay:0.91s;
    -ms-animation-delay:0.91s;
    -o-animation-delay:0.91s;
    animation-delay:0.91s;
  }

  #squaresWaveG_5{
    left:120px;
    -moz-animation-delay:1.04s;
    -webkit-animation-delay:1.04s;
    -ms-animation-delay:1.04s;
    -o-animation-delay:1.04s;
    animation-delay:1.04s;
  }

  #squaresWaveG_6{
    left:150px;
    -moz-animation-delay:1.17s;
    -webkit-animation-delay:1.17s;
    -ms-animation-delay:1.17s;
    -o-animation-delay:1.17s;
    animation-delay:1.17s;
  }

  #squaresWaveG_7{
    left:180px;
    -moz-animation-delay:1.3s;
    -webkit-animation-delay:1.3s;
    -ms-animation-delay:1.3s;
    -o-animation-delay:1.3s;
    animation-delay:1.3s;
  }

  #squaresWaveG_8{
    left:210px;
    -moz-animation-delay:1.43s;
    -webkit-animation-delay:1.43s;
    -ms-animation-delay:1.43s;
    -o-animation-delay:1.43s;
    animation-delay:1.43s;
  }

  @-moz-keyframes bounce_squaresWaveG{
    0%{
      background-color:#C0D630;
    }
    100%{
      background-color:#FFFFFF;
    }
  }

  @-webkit-keyframes bounce_squaresWaveG{
    0%{
      background-color:#C0D630;
    }
    100%{
      background-color:#FFFFFF;
    }
  }

  @-ms-keyframes bounce_squaresWaveG{
    0%{
      background-color:#C0D630;
    }
    100%{
      background-color:#FFFFFF;
    }
  }

  @-o-keyframes bounce_squaresWaveG{
    0%{
      background-color:#C0D630;
    }
    100%{
      background-color:#FFFFFF;
    }
  }

  @keyframes bounce_squaresWaveG{
    0%{
      background-color:#C0D630;
    }
    100%{
      background-color:#FFFFFF;
    }
  }


  /* Download tab: datatable styles */
  #datatable-container{
    margin-top:-26px;
    border:2px solid #BFD630;
    background-color:#BFD630;
  }

  #datatable-container table.dataTable thead .sorting_asc {
    background: url("http://cdn.datatables.net/1.10.0/images/sort_asc.png") no-repeat center left !important; /* Fix move sort icon to left */
  }

  #datatable-container table.dataTable thead .sorting_desc {
    background: url("http://cdn.datatables.net/1.10.0/images/sort_desc.png") no-repeat center left !important; /* Fix move sort icon to left */
  }

  #datatable-container table.dataTable thead .sorting {
    background: url("http://cdn.datatables.net/1.10.0/images/sort_both.png") no-repeat center left !important; /* Fix move sort icon to left */
  }

  #data-table-download{
    border-collapse:collapse;
    background-color:white;
    table-layout:fixed;
    width:200px;
    margin-bottom: 0px !important;
  }

  #data-table-download thead>tr>th{
    background-color:#EEE;
    padding-left: 16px !important;
  }

  #data-table-download td, th{
    padding:15px !important;
    overflow:hidden;
    width:100px;
  }

  #data-table-download .border-none{
    border-left:none !important;
    border-right:none !important;
    border-bottom:none !important;
    border-top:none !important;
  }

  #data-table-download .border-top-only{
    border-left:none !important;
    border-right:none !important;
    border-bottom:none !important;
    border-top:1px solid #CCC !important;
  }

  #data-table-download tbody>tr:hover{
    background-color:#F4EFB8;
  }

  span.vector, span.raster{
    display:inline;
    padding:.3em .6em .3em;
    font-size:80%;
    font-weight:bold;
    line-height:1;
    color:#fff;
    text-align:center;
    white-space:nowrap;
    vertical-align:baseline;
    border-radius:.25em;
  }

  span.vector{
    background-color:#FDA42C !important;
  }

  span.raster{
    background-color:#D21359 !important;
  }

  .download-button{
    margin-left:-15px;
    margin-top:-3px;
    margin-bottom:-3px;
    background-color:#50AEEC;
    color:white !important;
    text-decoration:none !important;
    padding-top:5px;
    padding-bottom:5px;
    padding-left:15px;
    padding-right:15px;
    border:none;
  }

  #data-table-download_info{
    padding-top:3px;
    padding-left:15px;
    float:left;
  }

  #data-table-download_length{
    float:left;
    padding-left:15px;
    padding-top:15px;
    padding-bottom:15px;
  }

  #data-table-download_filter{
    float:right;
    padding-top:15px;
    padding-right:15px;
  }

  #data-table-download_paginate{
    padding-top:3px;
    padding-right:15px;
    padding-bottom:15px;
    float:right;
  }


  /* Metadata tab styles */
  #detailed-metadata-title, #access-and-use-title{
    padding-top: 25px;
  }

  .detailed-metadata-container{
    border:1px solid #CCC;
    padding-top:15px;
    padding-left:15px;
    padding-right:15px;
    padding-bottom:0px;
    overflow: hidden;
  }

  .detailed-metadata-container dl{
    float:left;
    width:100%;
    margin-bottom:0px !important;
  }

  .detailed-metadata-container dt{
    float:left;
    width:24%;
    text-align:right;
  }

  .detailed-metadata-container dd{
    float:left;
    width:72%;
    padding-top:0px !important;
    padding-left:15px;
  }

  .detailed-metadata-container dd p{
    margin-bottom:0.5em !important;
  }

  #temporal_dynamic {
    display:none;
  }

  .label-tag{
    display:inline;
    padding:.2em .6em .3em;
    font-size:75%;
    font-weight:bold;
    line-height:1;
    text-align:center;
    text-decoration:none !important;
    white-space:nowrap;
    vertical-align:baseline;
    border-radius:.25em;
    background-color:#989898 !important;
    color: white !important;
  }

  .label-tag:hover{
    background-color:#4D4D4D !important;
    color:white !important;
  }

  #category{
    display:none; /* Fix Remove "Filed under" section */
  }
</style>

<dl class="enableFormTabbing">

  <!-- Map View -->
  <tal:mapview define="html context/embed_iframe">
    <dt id="fieldsetlegend-mapview" i18n:translate="">Map View</dt>
    <dd id="fieldset-mapview" style="margin:0px; padding-top:0px !important">
      <div class="mapview-field" style="border:1px solid #BFD630; border-top:0px;">
        <div class="loading_message" tal:condition="context/has_iframe">
          <div id="squaresWaveG">
            <div id="squaresWaveG_1" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_2" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_3" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_4" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_5" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_6" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_7" class="squaresWaveG">
            </div>
            <div id="squaresWaveG_8" class="squaresWaveG">
            </div>
          </div>
          <center>Please wait, loading map...</center>
        </div>
        <tal:service replace="structure html" />
      </div>
    </dd>
  </tal:mapview>

  <!-- Metadata -->
  <tal:metadata define="
    field python:context.getField('text') if getattr(context, 'getField', None) else None;
    html python:field.getAccessor(context)() if field else ''" tal:condition="html">
    <dt id="fieldsetlegend-metadata" i18n:translate="">Metadata</dt>
    <dd id="fieldset-metadata">
      <div class="metadata-field">
        <tal:service replace="structure html" />
        <tal:service replace="structure context/@@product-inline-view" />
      </div>
    </dd>
  </tal:metadata>

  <!-- Download -->
  <tal:download>
    <dt id="fieldsetlegend-download" i18n:translate="">Download</dt>
    <dd id="fieldset-download">
      <div id="datatable-container">
        <table id="data-table-download" width="100%" tal:define="catfields python:context.getField('fileCategories').getAccessor(context)()">
          <thead>
            <tr role="row">
              <th class="border-none">Name</th>
              <th class="border-none" tal:repeat="cat catfields"><span tal:replace="cat">Type</span></th>
              <th class="border-none">Download</th>
            </tr>
          </thead>

          <tbody >
            <tal:repeat repeat="item_brain python: context.getFolderContents(contentFilter={'portal_type' : 'LandFile'})">
              <tr tal:condition="python:item_brain.review_state == 'published'">
                <tal:def tal:define="item python:item_brain.getObject();
                    fileCategories python: item.getField('fileCategories').getAccessor(item)() or [{}];
                    fileCategories python: {d.get('name', ''): d.get('value', '') for d in fileCategories};
                    ">

                  <td class="border-top-only" tal:content="item/Title"></td>

                  <tal:repeat repeat="catName catfields">
                    <td tal:define="value python:fileCategories.get(catName, '')" class="border-top-only">
                      <span tal:content="python:value"
                            tal:attributes="class python:value.lower().replace(' ', '-')">Value</span>
                    </td>
                  </tal:repeat>
                  <td class="border-top-only">
                    <span class="info-size" tal:content="item/getFileSize">70.14 MB</span>
                    <a tal:attributes="href python: item.absolute_url() + '/@@redirect-download-url'"
                       href="" class="download-button"><b>Download</b></a>
                  </td>
                </tal:def>
              </tr>
            </tal:repeat>
          </tbody>
        </table>
      </div>

      <script type="text/javascript" language="javascript" src="//cdn.datatables.net/1.10.6/js/jquery.dataTables.min.js"></script>
      <script type="text/javascript" language="javascript" src="eea-tooltips.js"></script>

      <script>
        $(document).ready(function(){
          $('#data-table-download').DataTable();
          $('.download-button').hide();
          $('#data-table-download > tbody > tr').on("mouseenter", function () {
            $(this).find('a.download-button').show();
            $(this).find('span.info-size').hide();
          });

          $('#data-table-download > tbody > tr').on("mouseleave", function () {
            $(this).find('a.download-button').hide();
            $(this).find('span.info-size').show();
          });
        });
      </script>
    </dd>
  </tal:download>

  <!-- Download Old - temporary download -->
  <tal:download>
    <dt id="fieldsetlegend-download-old" i18n:translate="">Download (old)</dt>
    <dd id="fieldset-download-old"
        tal:define="download_info python: context.getField('download').getAccessor(context)()">
      <div tal:replace="structure download_info"></div>
    </dd>
  </tal:download>

</dl>

</metal:main_macro>

</metal:content-core>

</body>

</html>
